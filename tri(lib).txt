CREATE TABLE Library (
    BookID INT PRIMARY KEY,
    Title VARCHAR(255),
    Author VARCHAR(255),
    Genre VARCHAR(50),
    PublishedYear INT
);

CREATE TABLE Library_Audit (
    AuditID INT PRIMARY KEY AUTO_INCREMENT,
    BookID INT,
    Title VARCHAR(255),
    Author VARCHAR(255),
    Genre VARCHAR(50),
    PublishedYear INT,
    OperationType VARCHAR(10), -- 'UPDATE' or 'DELETE'
    OperationTimestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);


CREATE TRIGGER BeforeDeleteLibraryRow
BEFORE DELETE ON Library
FOR EACH ROW
BEGIN
    INSERT INTO Library_Audit (BookID, Title, Author, Genre, PublishedYear, OperationType)
    VALUES (OLD.BookID, OLD.Title, OLD.Author, OLD.Genre, OLD.PublishedYear, 'DELETE');
END;

CREATE TRIGGER BeforeUpdateLibraryRow
BEFORE UPDATE ON Library
FOR EACH ROW
BEGIN
    INSERT INTO Library_Audit (BookID, Title, Author, Genre, PublishedYear, OperationType)
    VALUES (OLD.BookID, OLD.Title, OLD.Author, OLD.Genre, OLD.PublishedYear, 'UPDATE');
END;

CREATE TRIGGER AfterDeleteLibraryStatement
AFTER DELETE ON Library
FOR EACH STATEMENT
BEGIN
    INSERT INTO Library_Audit (OperationType)
    VALUES ('DELETE STATEMENT');
END;

CREATE TRIGGER AfterUpdateLibraryStatement
AFTER UPDATE ON Library
FOR EACH STATEMENT
BEGIN
    INSERT INTO Library_Audit (OperationType)
    VALUES ('UPDATE STATEMENT');
END;

